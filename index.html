<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#0B3D91" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="DL Layout" />
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png" />
  <link rel="manifest" href="manifest.webmanifest" />
  <title>Damour Logistique ‚Äî SHOP Layout PRO (V9)</title>

  <style>
    :root{
      --cell: 22px;
      --bg: #0b1220;
      --panel: rgba(17,24,39,0.88);
      --panel2: rgba(17,24,39,0.96);
      --text: #f9fafb;
      --muted: #b7c4d8;
      --border: rgba(148,163,184,0.25);
      --brand: #0B3D91;
      --brand2: #1A63FF;
      --neon: #00B4FF;
      --danger: #ff4d4f;
      --ok: #12b76a;
      --warn: #f59e0b;
      --shadow: 0 18px 55px rgba(0,0,0,0.55);
      --radius: 14px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      /* type colors */
      --c-bin: #111827;
      --c-wall: #6b7280;
      --c-door: #12b76a;
      --c-work: #f59e0b;

      /* zones default */
      --zA: rgba(26,99,255,0.18);
      --zB: rgba(18,183,106,0.18);
      --zC: rgba(245,158,11,0.22);
      --zD: rgba(255,77,79,0.16);
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 10% 0%, rgba(26,99,255,0.25) 0%, rgba(11,18,32,1) 60%),
        radial-gradient(1000px 500px at 90% 20%, rgba(0,180,255,0.10) 0%, rgba(11,18,32,1) 60%);
      overflow:hidden;
      -webkit-font-smoothing: antialiased;
      -webkit-tap-highlight-color: transparent;
    }

    header{
      position: sticky;
      top:0;
      z-index: 10;
      background: rgba(10,16,28,0.78);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      box-shadow: 0 3px 14px rgba(0,0,0,0.35);
      padding-top: env(safe-area-inset-top);
    }

    .top{
      padding: 10px 12px 8px 12px;
      display:flex;
      align-items:center;
      gap: 10px;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 240px;
    }

    .brand img{
      width: 30px;
      height: 30px;
      border-radius: 12px;
      box-shadow: 0 10px 22px rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.10);
    }

    .brandTxt{ line-height:1.1; }
    .brandTxt .t{ font-weight: 950; font-size: 14px; letter-spacing:.2px; }
    .brandTxt .s{ color: var(--muted); font-size: 11px; font-weight: 850; }

    .menuBar{
      display:flex;
      gap: 8px;
      align-items:center;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    details.menu{ position: relative; }
    details.menu > summary{
      list-style:none;
      cursor:pointer;
      user-select:none;
      border: 1px solid var(--border);
      background: rgba(17,24,39,0.80);
      border-radius: 999px;
      padding: 8px 12px;
      font-size: 12px;
      font-weight: 950;
      color: var(--text);
      display:flex;
      align-items:center;
      gap: 8px;
      box-shadow: 0 1px 0 rgba(255,255,255,0.03);
    }
    details.menu > summary::-webkit-details-marker{ display:none; }
    details.menu[open] > summary{
      border-color: rgba(0,180,255,0.45);
      background: linear-gradient(135deg, rgba(11,61,145,0.55), rgba(26,99,255,0.22));
      color: #eaf2ff;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap: 6px;
      font-size: 11px;
      font-weight: 950;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(17,24,39,0.80);
      color: var(--muted);
      max-width: 44vw;
      overflow:hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }
    .badge.ok{ border-color: rgba(18,183,106,0.35); color: #89f0b8; }
    .badge.warn{ border-color: rgba(245,158,11,0.35); color: #ffd28a; }
    .badge.danger{ border-color: rgba(255,77,79,0.35); color: #ffb3b3; }

    .dropdown{
 position: fixed;
 left: 50%;
 transform: translateX(-50%);
 top: calc(var(--headerH, 160px) + env(safe-area-inset-top) + 8px);
 width: min(92vw, 420px);
 max-height: calc(100vh - (var(--headerH, 160px) + env(safe-area-inset-top) + 8px) - 14px - env(safe-area-inset-bottom));
 overflow: auto;
 background: var(--panel2);
 border: 1px solid var(--border);
 border-radius: var(--radius);
 box-shadow: var(--shadow);
 -webkit-overflow-scrolling: touch;
 z-index: 50;
 }

    .dropHead{
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 10px;
    }
    .dropHead .title{ font-size: 12px; font-weight: 950; }
    .dropBody{ padding: 10px 12px 12px 12px; }

    .btn{
      border: 1px solid var(--border);
      background: rgba(17,24,39,0.78);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      font-size: 12px;
      font-weight: 950;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap: 8px;
      cursor:pointer;
      user-select:none;
      width: 100%;
    }
    .btn + .btn{ margin-top: 8px; }
    .btn.primary{ background: linear-gradient(135deg, var(--brand) 0%, var(--brand2) 100%); color:#fff; border-color: rgba(255,255,255,0.10); }
    .btn.neon{ background: linear-gradient(135deg, rgba(0,180,255,0.35), rgba(26,99,255,0.20)); border-color: rgba(0,180,255,0.35); }
    .btn.danger{ border-color: rgba(255,77,79,0.35); color: #ffd1d1; }
    .btn.small{ padding: 8px 10px; border-radius: 10px; width: auto; }
    .btn.ghost{ background: transparent; }

    .row{ display:flex; gap: 8px; flex-wrap: wrap; align-items:center; }

    .hint{
      padding: 0 12px 10px 12px;
      color: var(--muted);
      font-size: 12px;
      font-weight: 850;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }

    .switch{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: rgba(17,24,39,0.78);
      font-size: 12px;
      font-weight: 950;
      color: var(--text);
    }
    .switch small{ color: var(--muted); font-weight: 850; }
    input[type="checkbox"]{ width: 18px; height: 18px; accent-color: var(--brand2); }

    .field{ margin-top: 10px; }
    .field label{ display:block; font-size: 12px; font-weight: 950; color: var(--text); }
    .field input, .field select{
      width: 100%;
      padding: 10px 12px;
      margin-top: 6px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 13px;
      font-weight: 900;
      background: rgba(17,24,39,0.78);
      color: var(--text);
    }

    textarea{
      width: 100%;
      height: 140px;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px;
      font-size: 11px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: rgba(17,24,39,0.78);
      color: var(--text);
    }

    /* Main */
    #main{
 position:absolute;
 top: calc(var(--headerH, 160px) + env(safe-area-inset-top));
      left:0;
      right:0;
      bottom:0;
      overflow: auto;
      padding: 12px;
      -webkit-overflow-scrolling: touch;
    }

    #gridWrap{
      width: max-content;
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position: relative;
    }

    #grid{
      display:grid;
      grid-template-columns: repeat(40, var(--cell));
      grid-auto-rows: var(--cell);
      background-image:
 linear-gradient(rgba(210,215,224,0.95) 1px, transparent 1px),
 linear-gradient(90deg, rgba(210,215,224,0.95) 1px, transparent 1px);
 background-size: var(--cell) var(--cell);
 background-color: #ffffff;
 background-color: #ffffff;
      touch-action: pan-x pan-y;
    }

    .cell{
      width: var(--cell);
      height: var(--cell);
      border: 1px solid rgba(210,215,224,0.95);
      background: #ffffff;
      cursor:pointer;
      font-size: 9px;
      font-weight: 950;
      text-align:center;
      line-height: var(--cell);
      user-select:none;
      color: #0b1220;
      position: relative;
    }

    .cell.highlight{ outline: 2px solid rgba(11,61,145,0.95); outline-offset: -2px; }

    .type-bin{ background: var(--c-bin); color:#fff; }
    .type-wall{ background: var(--c-wall); color:#fff; }
    .type-door{ background: var(--c-door); color:#062e1a; }
    .type-work{ background: var(--c-work); color:#1f2937; }

    /* zones overlay */
    .cell.zoneA::after,.cell.zoneB::after,.cell.zoneC::after,.cell.zoneD::after{ content:''; position:absolute; inset:0; pointer-events:none; }
    .cell.zoneA::after{ background: var(--zA); }
    .cell.zoneB::after{ background: var(--zB); }
    .cell.zoneC::after{ background: var(--zC); }
    .cell.zoneD::after{ background: var(--zD); }

    /* filter / x-ray */
    .hide-bins .type-bin{ opacity: 0.12; }
    .hide-walls .type-wall{ opacity: 0.12; }
    .hide-doors .type-door{ opacity: 0.12; }
    .hide-works .type-work{ opacity: 0.12; }
    .hide-zones .cell.zoneA::after,.hide-zones .cell.zoneB::after,.hide-zones .cell.zoneC::after,.hide-zones .cell.zoneD::after{ opacity: 0; }

    .xray .cell{ background: transparent !important; color: transparent !important; }
    .xray .cell::after{ opacity: 0 !important; }
    .xray .cell{ border-color: rgba(11,61,145,0.22); }
    .xray .cell.highlight{ outline-color: rgba(0,180,255,0.9); }
    .xray .type-wall{ border-color: rgba(255,255,255,0.22) !important; }

    /* selection rectangle */
    #selBox{
      position:absolute;
      border: 2px dashed rgba(0,180,255,0.95);
      border-radius: 10px;
      background: rgba(0,180,255,0.10);
      display:none;
      pointer-events:none;
      z-index: 5;
    }

    /* Modal BIN */
    #modal{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      display:none;
      align-items: center;
      justify-content: center;
      z-index: 30;
      padding: 16px;
    }

    #modalContent{
      width: min(420px, 92vw);
      background: rgba(17,24,39,0.96);
      border-radius: 14px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.55);
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .modalTop{
      padding: 12px 14px;
      background: linear-gradient(135deg, rgba(11,61,145,0.60), rgba(26,99,255,0.18));
      border-bottom: 1px solid var(--border);
    }

    .modalTop h2{ margin:0; font-size: 15px; font-weight: 950; }
    .modalTop p{ margin: 4px 0 0 0; font-size: 12px; color: var(--muted); font-weight: 850; }
    .modalBody{ padding: 12px 14px 14px 14px; }
    .modalButtons{ padding: 0 14px 14px 14px; display:flex; gap: 8px; justify-content:flex-end; }

    /* Toast */
    #toast{
      position: fixed;
      left: 50%;
      bottom: calc(14px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      background: rgba(17,24,39,0.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 950;
      display:none;
      z-index: 40;
      box-shadow: 0 16px 40px rgba(0,0,0,0.35);
      max-width: calc(100vw - 24px);
      text-align:center;
      border: 1px solid rgba(0,180,255,0.22);
    }

    /* List */
    .list{
      max-height: 320px;
      overflow:auto;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: rgba(0,0,0,0.10);
    }
    .listItem{
      padding: 10px 10px;
      border-bottom: 1px solid rgba(148,163,184,0.18);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      cursor:pointer;
      user-select:none;
    }
    .listItem:last-child{ border-bottom: none; }
    .listItem strong{ font-size: 12px; }
    .listItem small{ color: var(--muted); font-weight: 850; }

    @media (max-width: 740px){
      #main{ top: 132px; }
      details.menu > summary{ padding: 8px 10px; }
      .badge{ max-width: 42vw; }
      .brand{ min-width: 100%; }
    }
  
    /* ===== Layout Background (template) ===== */
    #bgLayout{
      position:absolute;
      left:0;
      top:0;
      width:100%;
      height:auto;
      opacity: 0.28;
      pointer-events:none;
      display:none;
      transform-origin: top left;
    }


    /* ===== BIN Wizard / Highlights (Damour Logistique) ===== */
    @keyframes dlPulse {
      0%   { box-shadow: 0 0 0 0 rgba(0,180,255,0.85), inset 0 0 0 0 rgba(0,180,255,0.0); }
      50%  { box-shadow: 0 0 0 6px rgba(0,180,255,0.12), inset 0 0 0 999px rgba(0,180,255,0.10); }
      100% { box-shadow: 0 0 0 0 rgba(0,180,255,0.85), inset 0 0 0 0 rgba(0,180,255,0.0); }
    }
    .cell.bin-start{ outline: 3px solid rgba(0,180,255,0.95) !important; outline-offset:-3px; animation: dlPulse .75s ease-in-out infinite; }
    .cell.bin-available{ box-shadow: inset 0 0 0 999px rgba(0,180,255,0.10); }
    .cell.bin-end{ outline: 3px solid rgba(0,180,255,0.65); outline-offset:-3px; box-shadow: inset 0 0 0 999px rgba(0,180,255,0.06); }

    #binWizard{ position:fixed; left:50%; transform:translateX(-50%); bottom:calc(14px + env(safe-area-inset-bottom)); width:min(92vw, 560px);
      background: rgba(17,24,39,0.92); border:1px solid rgba(0,180,255,0.22); border-radius:16px; box-shadow:0 22px 65px rgba(0,0,0,0.55);
      overflow:hidden; z-index:60; display:none; backdrop-filter: blur(10px);
    }
    #binWizard .bwTop{ padding:10px 12px; background: linear-gradient(135deg, rgba(0,180,255,0.20), rgba(26,99,255,0.12)); border-bottom:1px solid rgba(148,163,184,0.18);
      display:flex; align-items:center; justify-content:space-between; gap:10px; }
    #binWizard .bwTitle{ font-weight:950; font-size:12px; }
    #binWizard .bwStep{ color: rgba(191,219,254,0.95); font-weight:950; font-size:12px; }
    #binWizard .bwBody{ padding:10px 12px 12px 12px; }
    #binWizard .bwMsg{ font-size:12px; font-weight:900; color: rgba(245,248,255,0.92); }
    #binWizard .bwSub{ font-size:11px; font-weight:850; color: rgba(183,196,216,0.90); margin-top:4px; }
    #binWizard .bwGrid{ margin-top:10px; display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
    #binWizard .bwActions{ margin-top:10px; display:flex; gap:8px; justify-content:flex-end; }
    #binWizard .bwActions .btn{ width:auto; }
    #binWizard .bwProgress{ height:6px; background: rgba(148,163,184,0.18); border-radius:999px; overflow:hidden; margin-top:10px; }
    #binWizard .bwProgress>div{ height:100%; width:0%; background: linear-gradient(90deg, rgba(0,180,255,0.95), rgba(26,99,255,0.65)); }

</style>
</head>

<body>
<header>
  <div class="top">
    <div class="brand">
      <img src="branding/dl-cube-512.png" alt="DL" />
      <div class="brandTxt">
        <div class="t">Damour Logistique <span style="opacity:.7">‚Ä¢ V9</span></div>
        <div class="s">SHOP Layout PRO ‚Äî Rapport de plan plancher</div>
      </div>
    </div>

    <div class="menuBar">
      <span class="badge" id="onlineBadge">‚è≥</span>
      <span class="badge" id="dirtyBadge">Non sauvegard√©</span>

      <details class="menu" id="menuTools">
        <summary>üß∞ Outils</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Outils</div><button class="btn small ghost" data-close="menuTools">Fermer</button></div>
          <div class="dropBody">
            <div class="row" style="gap:10px;">
              <button class="btn" data-tool="binrange">BIN+ (ligne)</button>
              <button class="btn" data-tool="bin">BIN</button>
              <button class="btn" data-tool="label">Texte</button>
              <button class="btn" data-tool="wall">Mur</button>
              <button class="btn" data-tool="door">Porte</button>
              <button class="btn" data-tool="work">Poste</button>
              <button class="btn" data-tool="empty">Vide</button>
            </div>

            <div style="height:10px"></div>

            <div class="switch"><div>Peindre en glissant<br><small>Appuie + glisse pour remplir</small></div><input type="checkbox" id="paintDrag" checked /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Mode navigation (d√©faut)
              <br><small>ON = bouger la grille, OFF = modifier</small></div>
              <input type="checkbox" id="navMode" checked />
            </div>

            <div style="height:8px"></div>
            <div class="switch"><div>Mode s√©lection rectangle<br><small>Glisse pour s√©lectionner un bloc</small></div><input type="checkbox" id="selectMode" /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Afficher labels<br><small>Montre / cache les num√©ros</small></div><input type="checkbox" id="showLabels" checked /></div>

            <div style="height:10px"></div>

            <div class="field">
              <label>Zones (A/B/C/D)</label>
              <select id="zoneSelect">
                <option value="">Aucune</option>
                <option value="A">A ‚Äî Zone A</option>
                <option value="B">B ‚Äî Zone B</option>
                <option value="C">C ‚Äî Zone C</option>
                <option value="D">D ‚Äî Zone D</option>
              </select>
            </div>
            <button class="btn neon" id="btnApplyZone">üéØ Appliquer zone √† la s√©lection</button>

            <div style="height:10px"></div>
            <div class="field">
              <label>Noms des zones (pro)</label>
              <input id="zoneNameA" placeholder="Zone A (ex: Backstore)" />
              <input id="zoneNameB" placeholder="Zone B (ex: All√©e 1)" />
              <input id="zoneNameC" placeholder="Zone C (ex: R√©ception)" />
              <input id="zoneNameD" placeholder="Zone D (ex: Caisse)" />
            </div>
            <button class="btn" id="btnSaveZones">üíæ Sauver noms zones</button>
          </div>
        </div>
      </details>

      <details class="menu" id="menuView">
        <summary>üßø Vue</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Vue & filtres</div><button class="btn small ghost" data-close="menuView">Fermer</button></div>
          <div class="dropBody">
            <div class="switch"><div>Filtre BIN<br><small>Masquer/att√©nuer</small></div><input type="checkbox" id="fBins" /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Filtre Mur<br><small>Masquer/att√©nuer</small></div><input type="checkbox" id="fWalls" /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Filtre Porte<br><small>Masquer/att√©nuer</small></div><input type="checkbox" id="fDoors" /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Filtre Poste<br><small>Masquer/att√©nuer</small></div><input type="checkbox" id="fWorks" /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Masquer zones<br><small>Retire les overlays</small></div><input type="checkbox" id="fZones" /></div>
            <div style="height:8px"></div>
            <div class="switch"><div>Mode X‚ÄëRay<br><small>Voir seulement le maillage</small></div><input type="checkbox" id="xray" /></div>
          </div>
        </div>
      </details>

      <details class="menu" id="menuSearch">
        <summary>üîé Recherche</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Recherche</div><button class="btn small ghost" data-close="menuSearch">Fermer</button></div>
          <div class="dropBody">
            <div class="field">
              <label for="searchInput">BIN / label / binId</label>
              <input id="searchInput" placeholder="Ex: L3A01 ou 01 P6" autocomplete="off" />
            </div>
            <div class="row">
              <button class="btn" style="flex:1" id="btnFind">Trouver</button>
              <button class="btn" style="flex:1" id="btnNext">Suivant</button>
            </div>
            <div style="height:8px"></div>
            <div class="badge" id="searchStatus" style="width:100%; justify-content:center;">Aucun r√©sultat</div>
          </div>
        </div>
      </details>

      <details class="menu" id="menuBins">
        <summary>üìö BIN</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Liste des BIN</div><button class="btn small ghost" data-close="menuBins">Fermer</button></div>
          <div class="dropBody">
            <div class="field">
              <label>Filtrer (binId ou label)</label>
              <input id="binListFilter" placeholder="Ex: L3A" />
            </div>
            <div class="row">
              <button class="btn" style="flex:1" id="btnRefreshBins">Rafra√Æchir</button>
              <button class="btn" style="flex:1" id="btnExportCsv">Export CSV</button>
            </div>
            <div style="height:8px"></div>
            <div class="list" id="binList"></div>
          </div>
        </div>
      </details>

      <details class="menu" id="menuAudit">
        <summary>üß™ Audit</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Audit automatique</div><button class="btn small ghost" data-close="menuAudit">Fermer</button></div>
          <div class="dropBody">
            <button class="btn neon" id="btnRunAudit">‚ñ∂ Lancer audit</button>
            <div style="height:8px"></div>
            <div class="badge" id="auditSummary" style="width:100%; justify-content:center;">‚Äî</div>
            <div style="height:8px"></div>
            <div class="list" id="auditList"></div>
          </div>
        </div>
      </details>

      <details class="menu" id="menuActions">
        <summary>‚ö° Actions</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Actions</div><button class="btn small ghost" data-close="menuActions">Fermer</button></div>
          <div class="dropBody">
            <button class="btn primary" id="btnSaveLocal">üíæ Sauver</button>
            <button class="btn" id="btnLoadLocal">‚Ü©Ô∏è Charger</button>
            <div class="row">
              <button class="btn" style="flex:1" id="btnUndo">‚Ü∂ Annuler</button>
              <button class="btn" style="flex:1" id="btnRedo">‚Ü∑ Refaire</button>
            </div>
            <div class="row">
              <button class="btn" style="flex:1" id="btnCopyBlock">üìã Copier</button>
              <button class="btn" style="flex:1" id="btnPasteBlock">üì• Coller</button>
            </div>
            <div class="row">
              <button class="btn small" id="zoomOut">‚ûñ Zoom</button>
              <button class="btn small" id="zoomIn">‚ûï Zoom</button>
              <button class="btn small" id="btnFit">üß≠ Vue g√©n√©rale</button>
            </div>
            <button class="btn danger" id="btnClear">üßπ Tout vider</button>
          </div>
        </div>
      </details>

      <details class="menu" id="menuData">
        <summary>üì¶ Donn√©es</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Import / Export</div><button class="btn small ghost" data-close="menuData">Fermer</button></div>
          <div class="dropBody">
            <button class="btn" id="btnExport">Exporter JSON</button>
            <div class="row">
              <button class="btn" style="flex:1" id="btnCopy">Copier</button>
              <button class="btn" style="flex:1" id="btnDownload">T√©l√©charger</button>
            </div>
            <button class="btn" id="btnExportPng">üñºÔ∏è Export PNG</button>
            <button class="btn neon" id="btnExportPdf">üßæ Export PDF Pro</button>

            <input type="file" id="fileImport" accept="application/json" style="display:none" />
            <button class="btn" id="btnImport">Importer‚Ä¶</button>

            <div style="height:8px"></div>
            <textarea id="output" placeholder="Le JSON s‚Äôaffichera ici apr√®s ¬´ Exporter JSON ¬ª"></textarea>
          </div>
        </div>
      </details>

      <details class="menu" id="menuInfo">
        <summary>‚ÑπÔ∏è Infos</summary>
        <div class="dropdown">
          <div class="dropHead"><div class="title">Infos</div><button class="btn small ghost" data-close="menuInfo">Fermer</button></div>
          <div class="dropBody">
            <div class="badge" id="coords" style="width:100%; justify-content:center;">Aucune</div>
            <div style="height:10px"></div>
            <div class="badge" id="stats" style="width:100%; justify-content:center;">Stats‚Ä¶</div>

            <div style="height:10px"></div>
            <div class="switch"><div>Afficher le layout (fond)
              <br><small>Image de r√©f√©rence derri√®re la grille</small></div><input type="checkbox" id="bgToggle" /></div>
            <div style="height:8px"></div>
            <div class="field">
              <label>Opacit√© (fond)</label>
              <input id="bgOpacity" type="range" min="0" max="100" value="28" />
            </div>
            <div class="field">
              <label>√âchelle (fond)</label>
              <input id="bgScale" type="range" min="50" max="200" value="100" />
            </div>
            <input type="file" id="bgFile" accept="image/*" style="display:none" />
            <div class="row">
              <button class="btn" style="flex:1" id="bgImport">Importer image‚Ä¶</button>
              <button class="btn" style="flex:1" id="bgDefault">Image Lang√©lier</button>
            </div>

            <div style="height:10px"></div>
            <button class="btn" id="btnInstall">‚¨áÔ∏è Installer (PWA)</button>
            <button class="btn" id="btnHelp">‚å®Ô∏è Aide</button>
            <div style="height:8px"></div>
            <div class="badge" style="width:100%; justify-content:center;">iPhone: Safari ‚Üí Partager ‚Üí Sur l‚Äô√©cran d‚Äôaccueil</div>
          </div>
        </div>
      </details>

    </div>
  </div>

  <div class="hint" id="hint">
    <span id="hintText">Mode : Cr√©ation de BIN ‚Äì clic 1 = premi√®re extr√©mit√©.</span>
    <span class="badge" id="toolBadge">outil: binrange</span>
  </div>
</header>

<div id="main">
  <div id="gridWrap">
    <img id="bgLayout" alt="Layout" />
    <div id="grid" aria-label="Grille"></div>
    <div id="selBox"></div>
  </div>
</div>

<div id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
  <div id="modalContent">
    <div class="modalTop">
      <h2 id="modalTitle">Info de la BIN</h2>
      <p>Tu as choisi une ligne de BIN. Indique la section et le num√©ro.</p>
    </div>
    <div class="modalBody">
      <div class="field">
        <label for="sectionInput">Section (ex: L2A, L3B)</label>
        <input type="text" id="sectionInput" placeholder="L3A" autocomplete="off" />
      </div>
      <div class="field">
        <label for="numeroInput">Num√©ro (ex: 01, 02)</label>
        <input type="text" id="numeroInput" placeholder="01" inputmode="numeric" autocomplete="off" />
      </div>
    </div>
    <div class="modalButtons">
      <button class="btn" id="cancelBin">Annuler</button>
      <button class="btn primary" id="saveBin">Valider</button>
    </div>
  </div>
</div>

<div id="toast"></div>

<div id="binWizard" aria-live="polite">
  <div class="bwTop">
    <div>
      <div class="bwTitle">Cr√©ation de BIN ‚Äî Damour Logistique</div>
      <div class="bwStep" id="bwStep">√âtape 1/4</div>
    </div>
    <button class="btn small ghost" id="bwHide">Masquer</button>
  </div>
  <div class="bwBody">
    <div class="bwMsg" id="bwMsg">Choisis la 1√®re case (d√©part).</div>
    <div class="bwSub" id="bwSub">Max 10 cases. Chaque case = 48√ó48 pouces (4√ó4 pieds).</div>
    <div class="bwProgress"><div id="bwBar"></div></div>

    <div id="bwForm" style="display:none; margin-top:10px;">
      <div class="bwGrid">
        <div class="field">
          <label>Zone absolue</label>
          <select id="bwZoneAbs">
            <option value="L2">L2</option>
            <option value="L3" selected>L3</option>
            <option value="L5">L5</option>
          </select>
        </div>
        <div class="field">
          <label>All√©e / Rang√©e (A/B/C‚Ä¶)</label>
          <input id="bwAisle" placeholder="A" maxlength="1" />
        </div>
        <div class="field">
          <label>Emplacement (01..99)</label>
          <input id="bwSlot" placeholder="01" inputmode="numeric" maxlength="2" />
        </div>
        <div class="field">
          <label>Suffixe (optionnel)</label>
          <input id="bwSuffix" placeholder="A" maxlength="2" />
        </div>
        <div class="field" style="grid-column: 1 / -1;">
          <label>Type</label>
          <select id="bwType">
            <option value="P1">P1</option>
            <option value="P2">P2</option>
            <option value="P3">P3</option>
            <option value="P4">P4</option>
            <option value="P5">P5</option>
            <option value="P6">P6</option>
            <option value="P7" selected>P7</option>
            <option value="MAGASIN">MAGASIN</option>
            <option value="RACKING">RACKING</option>
          </select>
        </div>
      </div>

      <div class="bwSub" id="bwComputed" style="margin-top:10px;"></div>

      <div class="bwActions">
        <button class="btn" id="bwReset">Recommencer</button>
        <button class="btn primary" id="bwValidate" disabled>Valider la BIN</button>
      </div>
    </div>
  </div>
</div>


<script type="module" src="./src/main.js"></script>
</body>
</html>
